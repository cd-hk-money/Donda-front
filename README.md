# 🔁 돈다

> 재무제표 기반 주식가격 평가 서비스 프로젝트 **'돈다'** 의 웹 뷰 레포지토리 입니다.


## 개발 환경

<div>
  <div align=center>
    <img src="https://img.shields.io/badge/vue.js-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white">  
    <img src="https://img.shields.io/badge/typescript-3178C6?style=for-the-badge&logo=typescript&logoColor=white"> 
    <img src="https://img.shields.io/badge/html-E34F26?style=for-the-badge&logo=html5&logoColor=white"> 
    <img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> 
    <img src="https://img.shields.io/badge/vuetify-1867C0?style=for-the-badge&logo=vuetify&logoColor=white">       
  </div>

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/vue-2.6.14-green">
    <img src="https://img.shields.io/badge/vuetify-2.6.0-green">
    <img src="https://img.shields.io/badge/vuex-3.6.2-green">
    <img src="https://img.shields.io/badge/vuexClass-0.3.2-blue">
    <img src="https://img.shields.io/badge/vuePropertyDecorator-9.1.2-blue">
    <img src="https://img.shields.io/badge/vueRouter-3.5.3-green">
    <img src="https://img.shields.io/badge/chart.js-2.9.4-green">
    <img src="https://img.shields.io/badge/axios-0.26.1-green">           
  </div>
</div>

  <br>

  <div align=center>    
    <a href="https://vuejs.org/" target="_blank">
      <img src="https://img.shields.io/badge/vue.js-4FC08D?&logo=vue.js&logoColor=white">  
    </a>
    <img src="https://img.shields.io/badge/vue-2.6.14-green" />
  </div>

  프론트엔드 프레임워크 입니다. **Vuetify 2.6.0** 의 원활한 사용을 위해 Vue 2.6.0 버전을 채택하였습니다.

  * **Vuetify**가 곧 3.0 버전 정식 릴리즈가 될 예정입니다. 릴리즈 내역에는 **Vue3.0** 이상 지원 내용이 포함되므로, **Vue 3.0** 으로 마이그레이션을 고려중입니다. 
  자세한 내용은 [해당 링크](https://vuetifyjs.com/en/introduction/roadmap/#in-development)를 참조하세요.    

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/typescript-3178C6?&logo=typescript&logoColor=white">    
  </div>

  복잡한 주가 데이터를 원활히 다루고, 백엔드와의 원활한 소통을 위해, 타입을 정의하고 사용하기 용이한 **Typescript**를 채택하였습니다.   

  <br>

  <div align=center>
    <img src="https://img.shields.io/badge/vuetify-1867C0?&logo=vuetify&logoColor=white">    
    <img src="https://img.shields.io/badge/vuetify-2.6.0-green">
  </div>

  
  **Vue.js** 의 **CSS** 프레임워크 입니다. **CSS** 요소를 간편하고 빠르게 만들기 위해 채택하였습니다.
  
  * **Vuetify**가 곧 3.0 버전 정식 릴리즈가 될 예정입니다. 릴리즈 내역에는 **Vue3.0** 이상 지원 내용이 포함됩니다.
  자세한 내용은 [해당 링크](https://vuetifyjs.com/en/introduction/roadmap/#in-development)를 참조하세요.

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/vuex-3.6.2-green">
  </div>
  
  **Vue.js** 의 ***상태 관리 도구**** 라이브러리 입니다.
  * **vuex**가 곧 LTS 버전으로 들어갑니다. 따라서 **Vue.js** 에서 공식적으로 권하는 상태 관리 도구는 **vuex** 에서 *Mutation** 을 제거하고, 새로운 기능을 추가한 [Pinia](https://pinia.vuejs.org/introduction.html#why-should-i-use-pinia)입니다. 
  
   > ***상태 관리 도구**** : 컴포넌트 간의 데이터 전달이 아닌, 중앙 데이터 저장소(store) 를 통해 데이터를 관리하는 도구를 의미합니다. </br>
   > ***Mutation**** : vuex의 store의 *state** 를 변경하는 동기적 함수들을 의미합니다. </br>
   > ***state**** : 접근이 허용된 컴포넌트에서 공통적으로 사용 가능한 store의 변수들을 의미합니다.

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/vuexClass-0.3.2-blue">
  </div>
  
  **Vue2** 버전에서 **Typescript** 를 사용하여 클래스형 컴포넌트를 작성할 수 있도록 지원하는 라이브러리 입니다.

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/vuePropertyDecorator-9.1.2-blue">
  </div>

  **Vue2** 버전에서 **Typescript** 를 사용하여 데코레이터를 사용한 클래스형 컴포넌트를 작성할 수 있도록 지원하는 라이브러리 입니다.

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/vueRouter-3.5.3-green">
  </div>

  **Vue.js** 의 라우터입니다. SPA의 구현, 동적 라우팅, 사용자 정의 스크롤 등의 기능을 사용하기 위해 채택하였습니다.

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/chart.js-2.9.4-green">
  </div>

  차트를 쉽게 그릴 수 있는 **Javascript, Typescript** 라이브러리 입니다. 주가와 제무재표를 다양한 방식으로 시각화 하기 위해 채택하였습니다. **chart.js**는 특히 plugin 커스텀 기능이 강력하여 다양한 차트 시각 옵션을 설정할 수 있습니다. 자세한 내용은 하단의 차트 항목에서 살펴보시기 바랍니다.

  <br>

  <div align=center>    
    <img src="https://img.shields.io/badge/axios-0.26.1-green">           
  </div>
  
  HTTP 비동기 통신 라이브러리입니다. 백엔드 와의 데이터 통신을 위해 채택하였습니다. 관련 API 매핑은 하단의 API 항목에서 살펴보시기 바랍니다.

  --- 

##  📁 폴더 구조
  
 <!-- ![GitHub top language](https://img.shields.io/github/languages/top/codma1123/Donda-vue?style=plastic)

 <!-- ![GitHub top language](https://img.shields.io/github/languages/second/codma1123/Donda-vue?style=plastic) -->
  
```bash
📦src
 ┣ 📂@types
 ┃ ┣ 📂chartjs-plugin-zoom
 ┃ ┃ ┗ 📜index.d.ts
 ┃ ┣ 📂d3
 ┃ ┃ ┗ 📜index.d.ts
 ┃ ┣ 📂vue-mobile-detection
 ┃ ┃ ┗ 📜index.d.ts
 ┃ ┗ 📜index.d.ts
 ┣ 📂api
 ┃ ┣ 📜stocks.ts
 ┃ ┗ 📜types.ts
 ┣ 📂assets
 ┃ ┣ 📜koreaflag.png
 ┃ ┣ 📜logo.png
 ┃ ┣ 📜logo.svg
 ┃ ┣ 📜readme-chart1.png
 ┃ ┣ 📜readme-chart2.png
 ┃ ┣ 📜readme-chart3.png
 ┃ ┗ 📜usaflag.png
 ┣ 📂mixins
 ┃ ┣ 📜StoreMixin.vue
 ┃ ┣ 📜tools.ts
 ┃ ┗ 📜TopListMixin.vue
 ┣ 📂models
 ┃ ┣ 📜app.ts
 ┃ ┣ 📜interest.ts
 ┃ ┣ 📜market.ts
 ┃ ┣ 📜payload.ts
 ┃ ┣ 📜stock.ts
 ┃ ┗ 📜user.ts
 ┣ 📂plugins
 ┃ ┗ 📜vuetify.ts
 ┣ 📂routes
 ┃ ┗ 📜index.js
 ┣ 📂scss
 ┃ ┗ 📜variables.scss
 ┣ 📂store
 ┃ ┣ 📜index.ts
 ┃ ┣ 📜InterestStore.ts
 ┃ ┣ 📜MarketStore.ts
 ┃ ┣ 📜payload.ts
 ┃ ┣ 📜StockStore.ts
 ┃ ┗ 📜UserStore.ts
 ┣ 📂v2
 ┃ ┣ 📂components
 ┃ ┃ ┣ 📂detail
 ┃ ┃ ┃ ┣ 📂factories
 ┃ ┃ ┃ ┣ 📂finance
 ┃ ┃ ┃ ┃ ┣ 📜FinanceContentFactory.vue
 ┃ ┃ ┃ ┃ ┣ 📜InformationFactory.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockFinance.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockFinanceBarChart.vue
 ┃ ┃ ┃ ┃ ┗ 📜StockFinanceLineChart.vue
 ┃ ┃ ┃ ┣ 📂indicator
 ┃ ┃ ┃ ┃ ┣ 📜IndicatorContentFactory.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockIndicator.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockIndicatorBarChart.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockIndicatorChart.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockIndicatorDetail.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockIndicatorLineChart.vue
 ┃ ┃ ┃ ┃ ┗ 📜StockPolarAreaChart.vue
 ┃ ┃ ┃ ┣ 📂similar
 ┃ ┃ ┃ ┃ ┣ 📜NewsContentsFactory.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockNews.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockSimilar.vue
 ┃ ┃ ┃ ┃ ┗ 📜StockSimilarContents.vue
 ┃ ┃ ┃ ┣ 📂stock
 ┃ ┃ ┃ ┃ ┣ 📜Stock.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockBigChart.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockChartD3.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockChartD3LineBar.vue
 ┃ ┃ ┃ ┃ ┗ 📜StockInfo.vue
 ┃ ┃ ┃ ┣ 📂valuation
 ┃ ┃ ┃ ┃ ┣ 📜StockScore.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockScoreBarChart.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockValuation.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockValuationChart.vue
 ┃ ┃ ┃ ┃ ┣ 📜StockValuationSingleChart.vue
 ┃ ┃ ┃ ┃ ┗ 📜ValuationBackgroundChart.vue
 ┃ ┃ ┃ ┗ 📜StockDrawer.vue
 ┃ ┃ ┣ 📂home
 ┃ ┃ ┃ ┣ 📜HomeNav.vue
 ┃ ┃ ┃ ┣ 📜Market.vue
 ┃ ┃ ┃ ┣ 📜MarketChart.vue
 ┃ ┃ ┃ ┣ 📜MarketDesc.vue
 ┃ ┃ ┃ ┣ 📜MarketTrend.vue
 ┃ ┃ ┃ ┣ 📜MarketTrendFactory.vue
 ┃ ┃ ┃ ┣ 📜StockRecommend.vue
 ┃ ┃ ┃ ┗ 📜StockRecommendContent.vue
 ┃ ┃ ┣ 📂rank
 ┃ ┃ ┃ ┣ 📜RankComponent.vue
 ┃ ┃ ┃ ┗ 📜RankContents.vue
 ┃ ┃ ┗ 📂vuetify
 ┃ ┃ ┃ ┣ 📜BtnBadge.vue
 ┃ ┃ ┃ ┗ 📜ProgressCircular.vue
 ┃ ┗ 📂pages
 ┃ ┃ ┣ 📜Detail.vue
 ┃ ┃ ┣ 📜Footer.vue
 ┃ ┃ ┣ 📜Home.vue
 ┃ ┃ ┣ 📜NavBar.vue
 ┃ ┃ ┣ 📜RankV2.vue
 ┃ ┃ ┣ 📜SideBar.vue
 ┃ ┃ ┗ 📜SnackBar.vue
 ┣ 📜App.vue
 ┣ 📜main.ts
 ┣ 📜shims-tsx.d.ts
 ┣ 📜shims-vue.d.ts
 ┗ 📜shims-vuetify.d.ts

📂@types      - ts로 재정의한 npm 라이브러리를 담고 있습니다.
📂api         - api url과 요청 타입을 담고있습니다.
📂assets      - 외부 파일을 담습니다.
📂components  - 페이지에 그려질 컴포넌트들을 담고 있습니다. 
📂mixins      - Vue의 mixins과 각종 유틸 함수들을 담고 있습니다.      
📂models      - 각종 데이터 모델을 정의합니다.
📂pages       - 페이지를 담고 있습니다.
📂plugins     - Vue의 각종 plugins을 정의합니다.
📂routes      - 라우트 설정을 정의합니다.
📂store       - vuex store들을 정의합니다.

📂components
 ┣ 📂detail    - 디테일 페이지에 필요한 컴포넌트들을 담고 있습니다.
 ┣ 📂home      - 홈 페이지에 필요한 컴포넌트들을 담고 있습니다.
 ┣ 📂rank      - 랭크 페이지에 필요한 컴포넌트들을 담고 있습니다.

```
## 컴포넌트

## API

**돈다** 웹 뷰에서 API 요청은 **📦src/📂store** 에서 **Vuex**의 **@Action** 데코레이터로써 정의됩니다. <br>
**종목 하나의 정보** 를 가져오는  **getStock** 함수를 예시를 통해 알아봅시다.

**📦src/📂store/📜StockStoreV2.ts**
```js
  @Action
  public async getStock(name: string): Promise<void> {
    try {
      this.context.commit('updateState', {
        stockLoaded: true
      })

      const res = await axios.get(`/stock/${name}`, HEADER)

      this.context.commit('updateState', {
        stock: res.data,
        stockLoaded: false
      })
    } catch(e) {
      console.log(e)
    }
  }  
```

```js
  this.context.commit('updateState', {
    stockLoaded: true
  })
```

먼저, *context** 객체의 *commit** 함수를 호출합니다. 첫번째 인자로는 *Mutation** 이름, 두번째 인자는 첫번째 인자에 명시된 Mutation 의 인자로써 사용됩니다. 여기서는 **updateState**의 인자로써 **{ stockLoaded: true }** 를 보내어 호출합니다. <br>

> ***context**** : 현재 store의 메소드와 객체들을 가지고 있는 객체입니다.<br>
> ***commit**** : 현재 store의 *Mutation* 을 호출합니다. </br>
> ***Mutation**** : vuex의 store의 *state** 를 변경하는 동기적 함수들을 의미합니다. </br>
> ***state**** : 접근이 허용된 컴포넌트에서 공통적으로 사용 가능한 store의 변수들을 의미합니다. <br>

<br>


```js
  @Mutation
  public updateState(payload: IUpdateStateModel) {    
    Object.entries(payload).forEach(state => {
      this[state[0]] = state[1]
    })        
  }
```
**updateState** Mutation은 다음과 같이 정의되어 있습니다. 인자로받은 payload의 **key**값에 해당하는 **state**를 **value**값으로 대체합니다.

<br>

```js
  this.context.commit('updateState', {
    stockLoaded: true
  })
```
따라서, 해당 구문은 ***stockLoaded**** 라는 **state**값을 **true**로 변경한다는 의미가 됩니다.
> ***stockLoaded**** : 종목 하나의 정보를 가져오는 중임을 의미하는 로딩 변수입니다. true면 종목을 정보를 로딩하는중, false면 정보를 로딩 완료했다는 뜻입니다. 이 state는 로딩 화면을 시각화 할때 사용됩니다.

<br>

```js
  const res = await axios.get(`/stock/${name}`, HEADER)
```
로딩 변수를 true로 변경한 후, axios get 요청을 실행합니다. axios의 get 함수에서 첫번째 인자는 요청할 url을 의미합니다. 두번째 인자는 http 헤더를 의미합니다.
> **돈다** 에서 사용되는 전체 API 요청은 [해당 링크](https://github.com/cd-hk-money/stock-server)에서 확인하실 수 있습니다. 

<br>

```js
  this.context.commit('updateState', {
    stock: res.data,
    stockLoaded: false
  })
```

그 후, 다시 *context* 객체의 *commit* 함수를 호출합니다. 호출할 Mutation은 updateState입니다.

### 결과적으로 **stock** 이라는 종목 정보들을 담는 **state** 에 axios 요청으로 받은 응답 객체의 **data** 값이 들어가게 됩니다.


## 차트

<div align=center>

  ![readme-chart3](https://user-images.githubusercontent.com/82079706/181083053-9960d3be-ceb4-4388-bd55-abd1f30d8206.png)
  
  ![readme-chart1](https://user-images.githubusercontent.com/82079706/181082442-32fbc64f-197a-4d5c-a053-5f707a929a72.png)

  ![readme-chart2](https://user-images.githubusercontent.com/82079706/181082802-7a15d6bf-28bf-4fc0-9430-7ff2bf37ab44.png)


</div>

차트는 **돈다** 에서 가장 중요한 요소 중 하나입니다. <br>
**돈다** 에서 차트는 **chart.js** 라이브러리와 CSS를 사용하여 구현되었습니다.




